<table class="wrapper" width="100%" cellpadding="0" cellspacing="0" role="presentation" style="box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; position: relative; -premailer-cellpadding: 0; -premailer-cellspacing: 0; -premailer-width: 100%; background-color: #edf2f7; margin: 0; padding: 0; width: 100%;">
	<tbody>
		<tr>
			<td align="center" style="box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; position: relative;">
				<table class="content" width="100%" cellpadding="0" cellspacing="0" role="presentation" style="box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; position: relative; -premailer-cellpadding: 0; -premailer-cellspacing: 0; -premailer-width: 100%; margin: 0; padding: 0; width: 100%;">
					<tbody>
						<tr>
							<td class="header"></td>
						</tr>
						<!-- Email Body -->
						<tr>
							<td class="body" width="100%" cellpadding="0" cellspacing="0" style="box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; position: relative; -premailer-cellpadding: 0; -premailer-cellspacing: 0; -premailer-width: 100%; background-color: #edf2f7; border-bottom: 1px solid #edf2f7; border-top: 1px solid #edf2f7; margin: 0; padding: 0; width: 100%; border: hidden !important;">
								<table
									class="inner-body" align="center" width="640" cellpadding="0" cellspacing="0" role="presentation" style="box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; position: relative; -premailer-cellpadding: 0; -premailer-cellspacing: 0; -premailer-width: 640px; background-color: #ffffff; border-color: #e8e5ef; border-radius: 2px; border-width: 1px; box-shadow: 0 2px 0 rgba(0, 0, 150, 0.025), 2px 4px 0 rgba(0, 0, 150, 0.015); margin: 0 auto; padding: 0; width: 640px;">
									<!-- Body content -->
									<tbody>
										<tr>
											<td class="content-cell" style="box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; position: relative; max-width: 100vw; padding: 32px;">
												<h2>Shipping report</h2>
												-
												<p>
													<strong>Total packages sent:</strong>
													{{ data['packages'] }}<br>
												</p>
												<p>
													<strong>Total packages sent to ARAMAX:</strong>
													{{ data['packages_aramex'] }}<br>
												</p>
												<p>
													<strong>Total packages sent to BIGBOSS:</strong>
													{{ data['packages_bigboss'] }}<br>
												</p>
												<p>
													<strong>Total of processed deals:</strong>
													{{ data['deals']|length }}<br>
												</p>

												<p>
													<strong>Number of processed ARAMEX deals:</strong>
													{{ countAramex }}<br>
												</p>

												<p>
													<strong>Number of processed BIGBOSS deals:</strong>
													{{ countBigboss }}<br>
												</p>

												<h2>Number of packages per offer:</h2>
												<div class="table" style="box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; position: relative;">
													<table style="box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; position: relative; -premailer-cellpadding: 0; -premailer-cellspacing: 0; -premailer-width: 100%; margin: 30px auto; width: 100%;">
														<thead>
															<tr>
																<th align="left" style="border: solid 1px #ccc;padding: 4px;">Offer</th>
																<th align="left" style="border: solid 1px #ccc;padding: 4px;">Total</th>
															</tr>
														</thead>
														<tbody>
															{% for offer, total in data['offers'] %}
																<tr>
																	<td align="left" style="border: solid 1px #ccc;padding: 4px;">{{ offer }}</td>
																	<td align="left" style="border: solid 1px #ccc;padding: 4px;">{{ total }}</td>
																</tr>
															{% endfor %}
														</tbody>
													</table>
												</div>

												<h2>Package details:</h2>
												<div class="table" style="box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; position: relative;">
													<table style="box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; position: relative; -premailer-cellpadding: 0; -premailer-cellspacing: 0; -premailer-width: 100%; margin: 30px auto; width: 100%;">
														<thead>
															<tr>
																<th align="left" style="border: solid 1px #ccc;padding: 4px;">Deal</th>
																<th align="left" style="border: solid 1px #ccc;padding: 4px;">Contact</th>
																<th align="left" style="border: solid 1px #ccc;padding: 4px;">Offer</th>
																<th align="left" style="border: solid 1px #ccc;padding: 4px;">Quantity</th>
																<th align="left" style="border: solid 1px #ccc;padding: 4px;">SMS</th>
																<th align="left" style="border: solid 1px #ccc;padding: 4px;">Company</th>
																<th align="left" style="border: solid 1px #ccc;padding: 4px;">TrackNumber</th>
																<th align="left" style="border: solid 1px #ccc;padding: 4px;">Label</th>
															</tr>
														</thead>
														<tbody>
															{% for deal in data['deals'] %}
																<tr>
																	<td align="left" style="border: solid 1px #ccc;padding: 4px;">{{ deal['id'] }}</td>
																	<td align="left" style="border: solid 1px #ccc;padding: 4px;">{{ deal['title'] }}</td>
																	<td align="left" style="border: solid 1px #ccc;padding: 4px;">{{ deal['offer']['name'] }}</td>
																	<td align="left" style="border: solid 1px #ccc;padding: 4px;">{{ deal['offer']['quantity'] }}</td>
																	<td align="left" style="border: solid 1px #ccc;padding: 4px;">{{ deal['sms'] }}</td>
																	<td align="left" style="border: solid 1px #ccc;padding: 4px;">{{ deal['shipment']['company'] }}</td>
																	<td align="left" style="border: solid 1px #ccc;padding: 4px;">{{ deal['shipment']['id'] }}</td>
																	<td align="left" style="border: solid 1px #ccc;padding: 4px;">
																		{% if deal['shipment']['label'] %}
																			<a href="{{ deal['shipment']['label'] }}" download>Download</a>
																		{% else %}
																			---
																		{% endif %}
																	</td>
																</tr>
															{% endfor %}
														</tbody>
													</table>
												</div>

												{% if combined_aramex %}
													<h2>Link to the combined ARAMEX labels:</h2>
													<p>
														<a href="{{ combined_aramex }}" download>Download all Aramex labels combined</a>
													</p>
												{% endif %}

												{% if combined_bigboss %}
													<h2>Link to the combined BIGBOSS labels:</h2>
													<p>
														<a href="{{ combined_bigboss }}" download>Download all BigBoss labels combined</a>
													</p>
												{% endif %}

												<h2>Errors:</h2>
												{% if errors|length > 0 %}
													<div class="table" style="box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; position: relative;">
														<table style="box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; position: relative; -premailer-cellpadding: 0; -premailer-cellspacing: 0; -premailer-width: 100%; margin: 30px auto; width: 100%;">
															<thead>
																<tr>
																	<th align="left" style="border: solid 1px #ccc;padding: 4px;">Deal</th>
																	<th align="left" style="border: solid 1px #ccc;padding: 4px;">Company</th>
																	<th align="left" style="border: solid 1px #ccc;padding: 4px;">Error</th>
																</tr>
															</thead>
															<tbody>
																{% for error in errors %}
																	<tr>
																		<td align="left" style="border: solid 1px #ccc;padding: 4px;">{{ error['deal'] }}</td>
																		<td align="left" style="border: solid 1px #ccc;padding: 4px;">{{ error['company'] }}</td>
																		<td align="left" style="border: solid 1px #ccc;padding: 4px;">{{ error['message'] }}</td>
																	</tr>
																{% endfor %}
															</tbody>
														</table>
													</div>
												{% else %}
													<p>No errors detected.</p>
												{% endif %}
											</td>
										</tr>
									</tbody>
								</table>
							</td>
						</tr>
						<tr>
							<td>
								<table class="footer" align="center" width="570" cellpadding="0" cellspacing="0" role="presentation">
									<tbody>
										<tr>
											<td class="content-cell" align="center">
												<p>© 2025 Plumbill. Tous les droits sont réservés.</p>
											</td>
										</tr>
									</tbody>
								</table>
							</td>
						</tr>
					</tbody>
				</table>
			</td>
		</tr>
	</tbody>
</table>
